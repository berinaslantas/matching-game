<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>E≈üle≈ütirme Oyunu</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0d1117;
    color: #c9d1d9;
    margin: 0;
    padding: 20px;
    text-align: center;
}

h1 {
    margin-bottom: 12px;
}

#mainUnitSelect, #subUnitSelect, #startBtn {
    margin: 8px;
    padding: 6px 12px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #30363d;
    background: #161b22;
    color: #c9d1d9;
    cursor: pointer;
}

.game {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    margin-top: 12px;
}

.column {
    width: 48%;
}

.card {
    background: #161b22;
    padding: 15px;
    margin: 8px 0;
    border-radius: 12px;
    border: 1px solid #30363d;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.15s ease;
}

.card:hover {
    border-color: #58a6ff;
}

.card.selected {
    background: #21262d;
    border-color: #58a6ff;
}

/* Doƒüru e≈üle≈üme: ye≈üil kelime */
.card.correct {
    background: #161b22;
    color: #238636;
    border-color: #238636;
}

/* Yanlƒ±≈ü e≈üle≈üme: koyu turuncu kelime */
.card.wrong {
    background: #161b22;
    color: #b45309;
    border-color: #b45309;
}

#score {
    margin-top: 16px;
    font-size: 20px;
    color: #8b949e;
}
</style>
</head>

<body>
<h1>üîó E≈üle≈ütirme Oyunu</h1>

<div>
    <select id="mainUnitSelect">
        <option value="Tarih">Tarih</option>
        <option value="Matematik">Matematik</option>
    </select>
    <select id="subUnitSelect"></select>
    <button id="startBtn">Ba≈ülat</button>
</div>

<div class="game">
    <div class="column" id="left"></div>
    <div class="column" id="right"></div>
</div>

<div id="score">Skor: 0</div>

<script>
let streak = 0;
let score = 0;
let selectedLeft = null;
let selectedRight = null;
let pairs = [];

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// √úNƒ∞TE & ALT √úNƒ∞TE VERƒ∞Sƒ∞
const units = {
    "ƒ∞slamiyet √ñncesi T√ºrk Tarihi": {
        "T√ºrk adƒ±nƒ±n anlamlarƒ±": [
            { left: "Wambery", right: "T√ºremek" },
            { left: "Doerfer", right: "Devlete baƒülƒ± halk" },
            { left: "Ka≈ügarlƒ± Mahmut", right: "Olgunluk √áaƒüƒ±" },
            { left: "ƒ∞ran Kaynaklarƒ±", right: "G√ºzel ƒ∞nsan" },
            { left: "√áin Kaynaklarƒ±", right: "Miƒüfer" },
            { left: "Ziya G√∂kalp", right: "Kanun ve nizam sahibi" },
            { left: "Diƒüer", right: "G√º√ßl√º, kuvvetli, terk edilmi≈ü" }
        ],
        "Orta Asya K√ºlt√ºr Merkezleri": [
            { left: "Anav", right: "en eski (At ilk kez)" },
            { left: "Afanesyova", right: "en eski T√ºrk (Minusinsk)" },
            { left: "Tagar", right: "en geli≈ümi≈ü (Altaylƒ±lar)" },
            { left: "Andronova", right: "T√ºrk atalarƒ±nƒ±n ya≈üadƒ±ƒüƒ±" },
            { left: "Karasuk", right: "ilk demir i≈ülendiƒüi yer" },
            { left: "Kelteminar", right: "yerle≈üik ya≈üam" }
]

    },
    "Matematik": {
        "1. √únite": [
            { left: "2+2", right: "4" },
            { left: "5*3", right: "15" }
        ],
        "2. √únite": [
            { left: "10-6", right: "4" },
            { left: "12/3", right: "4" }
        ]
    }
};

// SES FONKSƒ∞YONLARI
function playDing() {
    const gain = audioCtx.createGain();
    gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.3, audioCtx.currentTime + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.35);
    gain.connect(audioCtx.destination);

    const osc = audioCtx.createOscillator();
    osc.type = "triangle";
    osc.frequency.setValueAtTime(700 + streak*20, audioCtx.currentTime);
    osc.connect(gain);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.35);
}

function playDong() {
    const freqs = [440, 220, 110];
    const gain = audioCtx.createGain();
    gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.15, audioCtx.currentTime + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.6);
    gain.connect(audioCtx.destination);

    freqs.forEach(f => {
        const osc = audioCtx.createOscillator();
        osc.type = "sine";
        osc.frequency.setValueAtTime(f, audioCtx.currentTime);
        osc.connect(gain);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.6);
    });
}

function resetStreak() { streak = 0; }

// KARTLARI √áƒ∞ZME
function shuffle(arr) { return arr.sort(() => Math.random()-0.5); }

function render() {
    const leftCol = document.getElementById("left");
    const rightCol = document.getElementById("right");
    leftCol.innerHTML = "";
    rightCol.innerHTML = "";

    shuffle([...pairs]).forEach(p => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerText = p.left;
        div.onclick = () => selectLeft(div, p.left);
        leftCol.appendChild(div);
    });

    shuffle([...pairs]).forEach(p => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerText = p.right;
        div.onclick = () => selectRight(div, p.right);
        rightCol.appendChild(div);
    });
}

function resetCards() {
    document.querySelectorAll(".card").forEach(card => {
        card.classList.remove("wrong", "selected");
    });
}

// SE√áƒ∞M FONKSƒ∞YONLARI
function selectLeft(el, value) {
    resetCards();
    document.querySelectorAll("#left .card").forEach(c => c.classList.remove("selected"));
    el.classList.add("selected");
    selectedLeft = value;
    check();
}

function selectRight(el, value) {
    resetCards();
    document.querySelectorAll("#right .card").forEach(c => c.classList.remove("selected"));
    el.classList.add("selected");
    selectedRight = value;
    check();
}

// E≈ûLE≈ûME KONTROL
function check() {
    if (!selectedLeft || !selectedRight) return;

    const leftCard = [...document.querySelectorAll("#left .card")].find(c => c.innerText === selectedLeft);
    const rightCard = [...document.querySelectorAll("#right .card")].find(c => c.innerText === selectedRight);

    const match = pairs.find(p => p.left === selectedLeft && p.right === selectedRight);

    if (match) {
        streak++;
        playDing();
        score++;
        document.getElementById("score").innerText = "Skor: " + score;

        leftCard.classList.add("correct");
        rightCard.classList.add("correct");

        pairs = pairs.filter(p => p !== match);
        setTimeout(render, 180);
    } else {
        resetStreak();
        playDong();
        leftCard.classList.add("wrong");
        rightCard.classList.add("wrong");
    }

    selectedLeft = null;
    selectedRight = null;
}

// ALT √úNƒ∞TE DOLDURMA
const mainUnitSelect = document.getElementById("mainUnitSelect");
const subUnitSelect = document.getElementById("subUnitSelect");

function updateSubUnits() {
    const mainUnit = mainUnitSelect.value;
    subUnitSelect.innerHTML = "";
    Object.keys(units[mainUnit]).forEach(sub => {
        const opt = document.createElement("option");
        opt.value = sub;
        opt.innerText = sub;
        subUnitSelect.appendChild(opt);
    });
}

// Ba≈ülangƒ±√ßta alt √ºniteleri doldur
updateSubUnits();
mainUnitSelect.onchange = updateSubUnits;

// √úNƒ∞TE BA≈ûLATMA
document.getElementById("startBtn").onclick = function() {
    const mainUnit = mainUnitSelect.value;
    const subUnit = subUnitSelect.value;
    pairs = [...units[mainUnit][subUnit]]; 
    streak = 0;
    score = 0;
    document.getElementById("score").innerText = "Skor: " + score;
    render();
};
</script>
</body>
</html>
