<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>EÅŸleÅŸtirme Oyunu</title>

<link rel="manifest" href="manifest.json">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: #0d1117;
    color: #c9d1d9;
    margin: 0;
    padding: 20px;
    text-align: center;
}
h1 { margin-bottom: 12px; }
select, button {
    margin: 8px;
    padding: 6px 12px;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid #30363d;
    background: #161b22;
    color: #c9d1d9;
}
.game {
    display: flex;
    justify-content: space-between;
    gap: 12px;
    margin-top: 12px;
}
.column { width: 48%; }
.card {
    background: #161b22;
    padding: 15px;
    margin: 8px 0;
    border-radius: 12px;
    border: 1px solid #30363d;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.15s ease;
}
.card.selected { border-color: #58a6ff; }
.card.correct { color: #238636; border-color: #238636; }
.card.wrong { color: #b45309; border-color: #b45309; }
#score { margin-top: 16px; font-size: 20px; }
</style>
</head>

<body>
<h1>ðŸ”— EÅŸleÅŸtirme Oyunu</h1>

<div>
    <select id="mainUnitSelect">
        <option value="Ä°slamiyet Ã–ncesi TÃ¼rk Tarihi">Tarih</option>
        <option value="Matematik">Matematik</option>
    </select>
    <select id="subUnitSelect"></select>
    <button id="startBtn">BaÅŸlat</button>
    <button id="wrongsBtn">Genel YanlÄ±ÅŸlar</button>
</div>

<div class="game">
    <div class="column" id="left"></div>
    <div class="column" id="right"></div>
</div>

<div id="score">Skor: 0</div>

<script>
/* ===== GLOBAL ===== */
let streak = 0;
let score = 0;
let selectedLeft = null;
let selectedRight = null;
let pairs = [];
let isGeneralWrongsMode = false;

const STORAGE_KEY = "matching_game_progress_v1";
const generalWrongs = new Map();
const statsIndex = {};

const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

/* ===== SES (ORÄ°JÄ°NAL) ===== */
function playDing() {
    const gain = audioCtx.createGain();
    gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.3, audioCtx.currentTime + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.35);
    gain.connect(audioCtx.destination);

    const osc = audioCtx.createOscillator();
    osc.type = "triangle";
    osc.frequency.setValueAtTime(700 + streak*20, audioCtx.currentTime);
    osc.connect(gain);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.35);
}

function playDong() {
    const freqs = [440, 220, 110];
    const gain = audioCtx.createGain();
    gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.15, audioCtx.currentTime + 0.01);
    gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + 0.6);
    gain.connect(audioCtx.destination);

    freqs.forEach(f => {
        const osc = audioCtx.createOscillator();
        osc.type = "sine";
        osc.frequency.setValueAtTime(f, audioCtx.currentTime);
        osc.connect(gain);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.6);
    });
}

/* ===== VERÄ° ===== */
const units = {
    "Ä°slamiyet Ã–ncesi TÃ¼rk Tarihi": {
        "TÃ¼rk adÄ±nÄ±n anlamlarÄ±": [
            { left: "Wambery", right: "TÃ¼remek" },
            { left: "Doerfer", right: "Devlete baÄŸlÄ± halk" },
            { left: "KaÅŸgarlÄ± Mahmut", right: "Olgunluk Ã‡aÄŸÄ±" },
            { left: "Ä°ran KaynaklarÄ±", right: "GÃ¼zel Ä°nsan" },
            { left: "Ã‡in KaynaklarÄ±", right: "MiÄŸfer" },
            { left: "Ziya GÃ¶kalp", right: "Kanun ve nizam sahibi" },
            { left: "DiÄŸer", right: "GÃ¼Ã§lÃ¼, kuvvetli, terk edilmiÅŸ" }
        ],
        "Orta Asya KÃ¼ltÃ¼r Merkezleri": [
            { left: "Anav", right: "en eski (At ilk kez)" },
            { left: "Afanesyova", right: "en eski TÃ¼rk (Minusinsk)" },
            { left: "Tagar", right: "en geliÅŸmiÅŸ (AltaylÄ±lar)" },
            { left: "Andronova", right: "TÃ¼rk atalarÄ±nÄ±n yaÅŸadÄ±ÄŸÄ±" },
            { left: "Karasuk", right: "ilk demir iÅŸlendiÄŸi yer" },
            { left: "Kelteminar", right: "yerleÅŸik yaÅŸam" }
        ],
        "Boylar": [
            { left: "Anav", right: "en eski (At ilk kez)" },
            { left: "Afanesyova", right: "en eski TÃ¼rk (Minusinsk)" },
            { left: "Tagar", right: "en geliÅŸmiÅŸ (AltaylÄ±lar)" },
            { left: "Andronova", right: "TÃ¼rk atalarÄ±nÄ±n yaÅŸadÄ±ÄŸÄ±" },
            { left: "Karasuk", right: "ilk demir iÅŸlendiÄŸi yer" },
            { left: "Kelteminar", right: "yerleÅŸik yaÅŸam" }
        ],
        "Orta Asya TÃ¼rkleri": [
            { left: "Sakalar", right: "Bilinen ilk TÃ¼rk boyu" },
            { left: "Sakalar", right: "Alp Er Tunga" },
            { left: "Sakalar", right: "lk TÃ¼rk kadÄ±n hÃ¼kÃ¼mdar Tomris Hatun" },
            { left: "Sakalar", right: "Amazon (kadÄ±n savaÅŸÃ§Ä±lar)" },
            { left: "Sakalar", right: "Balbal (mezar taÅŸÄ±) dikme geleneÄŸi" },
            { left: "Sakalar", right: "AtÄ± evcilleÅŸtirmiÅŸ dÃ¼nyada ilk Ã¼zengi" },
            { left: "Sakalar", right: "GÃ¼nÃ¼mÃ¼zde Rusya Federasyonunda Yakut TÃ¼rkleri" },
            { left: "Sakalar", right: "BozkÄ±rÄ±n kuyumcularÄ±" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "Kurucusu Teoman" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "BaÅŸkenti Ã–tÃ¼ken. Kutsal bÃ¶lge veya Toprak Ana" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "Mete Vatan Sevgisi(Tunguzlara toprak vermeyip) ilk TÃ¼rk hÃ¼kÃ¼mdar" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "Mete orduda onlu sistem" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "TÃ¼rk tarihinin ilk yazÄ±lÄ± antlaÅŸmasÄ± Ã‡inlilerle yapÄ±lan Kuzey Åžansi" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "Orta Asyada Mete TÃ¼rk boylarÄ±nÄ±(26) bir bayrak altÄ±nda toplayan ilk devlet" },
            { left: "Asya Hun Devleti (BÃ¼yÃ¼k Hun)", right: "Orta Asyada ilk defa siyasi birlik -Mete Han" },
            { left: "Mukan KaÄŸan", right: "I. GÃ¶ktÃ¼rklerde TÃ¼rk siyasi birliÄŸi saÄŸlayan" },
            { left: "Kapgan KaÄŸan", right: "II. GÃ¶ktÃ¼rklerde TÃ¼rk siyasi birliÄŸi saÄŸlayan" },
            { left: "BatÄ± Hun hÃ¼kÃ¼mdarÄ± Ã‡iÃ§i ", right: " istiklali feda etmeyi gÃ¼lÃ¼nÃ§ ve utanÃ§ verici bulmuÅŸ " },
            { left: "BatÄ± Hun hÃ¼kÃ¼mdarÄ± Balamir", right: "Kavimler gÃ¶Ã§Ã¼ne Ã¶nderlik etmiÅŸ" }
        ],
            "Avrupa TÃ¼rkleri": [
            { left: "Avrupa Hun Devleti", right: "Kurucusu Balamir -Macaristanda" },
            { left: "Avrupa Hun Devleti en parlak dÃ¶nem", right: "Attila" },
            { left: "Avrupa Hun Devleti", right: "Avrupa'da kurulan ilk TÃ¼rk devleti" },
            { left: "Hem Orta Asya hem Avrupada Kurulanlar", right: "BÃ¼yÃ¼k Hunlar ve Avarlar" },
            { left: "Avrupa Hun Devleti", right: "Margos BarÄ±ÅŸÄ± ve Anatolyus Ant." },
            { left: "Avrupa Hun Devleti", right: "Galya ve Ä°talya seferleri (PapanÄ±n ricasÄ±)" },
            { left: "Atilla'nÄ±n Roma'yÄ± almaktan vazgeÃ§me nedenleri:", right: "Papa I. Leon'un ricasÄ±", "Roma'nÄ±n Hristiyanlarca kutsal olmasÄ±", "BatÄ± Roma'nÄ±n gÃ¼cÃ¼nÃ¼ kÄ±rdÄ±ÄŸÄ±na inanmasÄ±",
"DoÄŸuda Sasani tehlikesinin bulunmasÄ±" },
            { left: "Attilla'nÄ±n Ã¼nvanlarÄ± ", right: "(Etzel (Nibelungen)(Hun burgant mÃ¼cadelesi)", "Cesur Kavimlerin Efendisi", "TanrÄ±nÄ±n kamÃ§Ä±sÄ±" },
            { left: "Avarlar", right: "Kurucusu Bayan Han" },
            { left: "Avarlar", right: "Ä°stanbul'u kuÅŸatan ilk TÃ¼rk devleti (2 kere)" },
            { left: "Avarlar", right: "Ãœzengi yapÄ±mÄ±nÄ± AvrupalÄ±lara Ã¶ÄŸretmiÅŸ" },
            { left: "Avarlar", right: "Juan Juan TÃ¼rkleri" },
            { left: "Avarlar", right: "Frank saldÄ±rÄ±larÄ±yla yÄ±kÄ±lmÄ±ÅŸ" },
            { left: "PeÃ§enekler", "Avar", "Tuna BulgarlarÄ±", right: "Ä°stanbul'u kuÅŸatmÄ±ÅŸ" },
            { left: "PeÃ§enekler", "Uzlar", "KÄ±pÃ§aklar", right: "Bizans'ta Ã¼cretli askerlik" },
            { left: "PeÃ§enekler", "Uzlar", "KÄ±pÃ§aklar", right: "Malazgirt savaÅŸÄ± sÄ±rasÄ±nda taraf deÄŸiÅŸtirmiÅŸ" },
            { left: "Uzlar", right: "OÄŸuzlarÄ±n Hristiyan olanÄ±" },
            { left: "Uzlar", right: " Romanya'nÄ±n Dobruca - Gagavuz TÃ¼rkleri" },
            { left: "Macarlar", right: "TÃ¼rk tarihinde ilk defa TÃ¼rkoloji enstitÃ¼sÃ¼nÃ¼ kurmuÅŸ" },
            { left: "Macarlar", right: "TÃ¼rk kurultayÄ± (2008-) BUGAC" },
            { left: "Macarlar", right: "Bilinen ilk liderleri Arpad" },
            { left: "Bulgarlar", right: "kelime anlamÄ± karÄ±ÅŸÄ±k - karÄ±ÅŸmak" },
            { left: "Bulgarlar (Ä°til)", right: "AlmÄ±ÅŸ Han zamanÄ±nda MÃ¼slÃ¼man" },
            { left: "Bulgarlar (Ä°til)", right: "Ä°bn-i Fablan Rihle (Yolculuk) eseri" },
            { left: "Bulgarlar (Ä°til)", right: "Ä°lk MÃ¼slÃ¼man TÃ¼rk devletidir" },
            { left: "Bulgarlar (Ä°til)", right: "Avrupa'nÄ±n kuzeyinde kurulmuÅŸ" },
            { left: "Bulgarlar (Ä°til)", right: "Ä°slamiyet devletin resmi dini diyen ilk TÃ¼rk devleti" },
            { left: "Bulgarlar (Tuna)", right: "BarÄ±ÅŸ Han zamanÄ±nda Hristiyan " },
            { left: "Bulgarlar (Tuna)", right: "Han unvanÄ±nÄ± bÄ±rakÄ±p Ã‡ar unvanÄ± -Simon" },
            { left: "Sibirler", right: "yoldan sapan" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "OÄŸuzlarla -Dede Korkut Hikayeleri" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "Ruslarla mÃ¼cadelede Ä°gor destanÄ±" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "Codex Cumanius adÄ±nda sÃ¶zlÃ¼k " },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "Eyyubilerin ve memlÃ¼klÃ¼lerin ordusunda Ã¼cretli askerlik" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "BÃ¶lgeye isimlerini vermiÅŸler Dest-i KÄ±pÃ§ak" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "sarÄ±,sarÄ±mtrak,sarÄ± saÃ§lÄ±, Ã¶fkeli" },
            { left: "KÄ±pÃ§aklar (Kumanlar)", right: "AltÄ±norda Dev. TÃ¼rkleÅŸmesinde rol oynamÄ±ÅŸ" },
            { left: "Hazarlar", right: "MuseviliÄŸi kabul eden ilk ve son tÃ¼rk devleti" },
            { left: "Hazarlar","TÃ¼rgiÅŸler", right: "Emevilerle savaÅŸÄ±p maveraunnehirin islamlaÅŸmasÄ±nÄ± Ã¶nledi" },
            { left: "Hazarlar", right: "KÃ¼rk yolunu kullanarak zenginleÅŸmiÅŸ" },
            { left: "MaveraÃ¼nnehir", right: "Seyhun ile Ceyhun arasÄ±ndaki bÃ¶lgey" },
            { left: "Hazarlar", right: "TÃ¼rk tarihinde ilk kez ordusuna Ã¼cretli asker almÄ±ÅŸ" },
            { left: "Hazarlar", right: "YaÅŸadÄ±klarÄ± dÃ¶neme Pax Hazaria"" },
            { left: "Hazarlar", right: "Polonya'da Karaim veya KaraÃ§ay TÃ¼rkleri" },
            { left: "Hazarlar", right: "MÃ¼slÃ¼manlarÄ±n baÅŸlarÄ±na Hazz adlÄ± yÃ¶netici" }
        ]
     },
    "Matematik": {
        "1. Ãœnite": [
            { left: "2+2", right: "4" },
            { left: "5*3", right: "15" }
        ]
    }
};

/* ===== INDEX ===== */
function buildIndex() {
    Object.values(units).forEach(u =>
        Object.values(u).forEach(list =>
            list.forEach(q => {
                const k = q.left + "||" + q.right;
                if (!statsIndex[k]) {
                    statsIndex[k] = { wrongCount: 0, correctInWrongs: 0 };
                }
            })
        )
    );
}

/* ===== STORAGE ===== */
function saveProgress() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify({
        statsIndex,
        generalWrongs: [...generalWrongs.keys()]
    }));
}

function loadProgress() {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (!raw) return;
    const data = JSON.parse(raw);
    Object.assign(statsIndex, data.statsIndex || {});
    (data.generalWrongs || []).forEach(k => generalWrongs.set(k, true));
}

/* ===== OYUN ===== */
function shuffle(a) { return a.sort(() => Math.random() - 0.5); }

function resetCards() {
    document.querySelectorAll(".card").forEach(c =>
        c.classList.remove("selected","wrong")
    );
}

function render() {
    left.innerHTML = "";
    right.innerHTML = "";
    shuffle([...pairs]).forEach(p => {
        const d = document.createElement("div");
        d.className = "card";
        d.innerText = p.left;
        d.onclick = () => selectLeft(d, p);
        left.appendChild(d);
    });
    shuffle([...pairs]).forEach(p => {
        const d = document.createElement("div");
        d.className = "card";
        d.innerText = p.right;
        d.onclick = () => selectRight(d, p);
        right.appendChild(d);
    });
}

function selectLeft(el, p) {
    resetCards();
    document.querySelectorAll("#left .card").forEach(c => c.classList.remove("selected"));
    el.classList.add("selected");
    selectedLeft = p;
    check();
}

function selectRight(el, p) {
    resetCards();
    document.querySelectorAll("#right .card").forEach(c => c.classList.remove("selected"));
    el.classList.add("selected");
    selectedRight = p;
    check();
}

function check() {
    if (!selectedLeft || !selectedRight) return;

    const leftCard = [...left.children].find(c => c.innerText === selectedLeft.left);
    const rightCard = [...right.children].find(c => c.innerText === selectedRight.right);
    const key = selectedLeft.left + "||" + selectedLeft.right;
    const stat = statsIndex[key];

    if (selectedLeft.right === selectedRight.right) {
        streak++;
        playDing();
        score++;
        document.getElementById("score").innerText = "Skor: " + score;

        leftCard.classList.add("correct");
        rightCard.classList.add("correct");

        if (generalWrongs.has(key)) {
            stat.correctInWrongs++;
            if (stat.correctInWrongs >= 2) {
                generalWrongs.delete(key);
                stat.correctInWrongs = 0;
                stat.wrongCount = 0;
            }
        }

        pairs = pairs.filter(p => p !== selectedLeft);
        setTimeout(render, 180);
    } else {
        playDong();
        leftCard.classList.add("wrong");
        rightCard.classList.add("wrong");
        stat.wrongCount++;
        if (stat.wrongCount >= 3) generalWrongs.set(key, true);
    }

    saveProgress();
    selectedLeft = selectedRight = null;
}

/* ===== ÃœNÄ°TE ===== */
function updateSubUnits() {
    subUnitSelect.innerHTML = "";
    Object.keys(units[mainUnitSelect.value]).forEach(s => {
        const o = document.createElement("option");
        o.value = s;
        o.textContent = s;
        subUnitSelect.appendChild(o);
    });
}

mainUnitSelect.onchange = updateSubUnits;
updateSubUnits();

startBtn.onclick = () => {
    const m = mainUnitSelect.value;
    const s = subUnitSelect.value;
    pairs = units[m][s].map(q => q);
    score = 0;
    streak = 0;
    isGeneralWrongsMode = false;
    document.getElementById("score").innerText = "Skor: 0";
    render();
};

/* ===== GENEL YANLIÅžLAR ===== */
function startGeneralWrongsMode() {
    if (generalWrongs.size === 0) {
        alert("Genel yanlÄ±ÅŸ yok ðŸŽ‰");
        return;
    }

    isGeneralWrongsMode = true;

    pairs = [];
    generalWrongs.forEach((_, key) => {
        const [left, right] = key.split("||");
        pairs.push({ left, right });
    });

    score = 0;
    streak = 0;
    document.getElementById("score").innerText = "Genel YanlÄ±ÅŸlar";

    render();
}

wrongsBtn.onclick = startGeneralWrongsMode;

/* ===== BAÅžLAT ===== */
buildIndex();
loadProgress();
</script>
</body>
</html>



